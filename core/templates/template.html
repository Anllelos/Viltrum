<!DOCTYPE html>
<html lang="es">

<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>{% block title %}Viltrum{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap">

    <!-- CSS principal y Bootstrap -->
    <link rel="stylesheet" href="{% static 'core/css/template.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

    {% block extra_css %}{% endblock %}
</head>

<body>
    <!-- Header -->
    <header class="header-container">
        <div class="header-left">
            <a href="{% url 'home' %}" class="logo-animation">
                <div class="loader">
                    <p>Viltrum</p>
                    <div class="words">
                        <span class="word">eSports</span>
                        <span class="word">Gaming</span>
                        <span class="word">Torneos</span>
                        <span class="word">Competir</span>
                        <span class="word">Equipo</span>
                        <span class="word">Clasificaciones</span>
                        <span class="word">Comunidad</span>
                        <span class="word">Diversión</span>
                    </div>
                </div>
            </a>
        </div>

        <nav class="nav-center">
            <a href="{% url 'home' %}" class="viltrum-nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                <i class="bi bi-house-door-fill"></i> Inicio
            </a>
            <a href="{% url 'explore' %}" class="viltrum-nav-link {% if request.resolver_match.url_name == 'explore' %}active{% endif %}">
                <i class="bi bi-compass-fill"></i> Explorar
            </a>
            <a href="{% url 'tournaments' %}" class="viltrum-nav-link {% if request.resolver_match.url_name == 'tournaments' %}active{% endif %}">
                <i class="bi bi-trophy-fill"></i> Torneos
            </a>
            <a href="{% url 'clasifications' %}" class="viltrum-nav-link {% if request.resolver_match.url_name == 'clasifications' %}active{% endif %}">
                <i class="bi bi-graph-up-arrow"></i> Clasificaciones
            </a>
        </nav>

        <div class="header-right">
            <div class="search-bar">
                <input type="text" placeholder="Buscar...">
                <button class="search-btn"><i class="bi bi-search"></i></button>
            </div>

            {% if user.is_authenticated %}
            <a class="icon-button" href="{% url 'chats_list' %}"><i class="bi bi-chat-left-fill"></i></a>

            <!-- Dropdown de Notificaciones -->
            <div class="dropdown">
                <button class="icon-button" id="notification-toggle" aria-expanded="false">
                    <i class="bi bi-bell-fill"></i>
                </button>
                <div class="dropdown-content notifications" id="notification-dropdown">
                    {% for notification in notifications %}
                    <div class="notification">
                        <div class="notiglow"></div>
                        <div class="notiborderglow"></div>
                        <div class="notititle">{{ notification.title }}</div>
                        <div class="notibody">{{ notification.message }}</div>
                    </div>
                    {% empty %}
                    <div class="notification">
                        <div class="notititle">No hay nuevas notificaciones</div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Dropdown de Perfil -->
            <div class="dropdown">
                <button class="profile-button">
                    <img src="{% static 'images/profile_placeholder.png' %}" alt="Perfil">
                </button>
                <div class="dropdown-content">
                    <a href="{% url 'redirect_profile'%}"><i class="bi bi-person-circle"></i> Mi Perfil</a>
                    <a href="{% url 'redirect_profile_edit' %}"><i class="bi bi-pencil"></i> Editar Perfil</a>
                    {% if verified %}
                    <p>Tu perfil ya está verificado</p>
                    {% else %}
                    <a href="{% url 'verification' user %}"><i class="bi bi-patch-check-fill"></i> Verificar perfil</a>
                    {% endif %}
                    {% if role == 'gamer' %}
                    
                    <a href="{% url 'games_stats' %}"><i class="bi bi-bar-chart-fill"></i> Estadísticas</a>
                    {% else %}
                    <a href="{% url 'sponsor_products' %}"><i class="bi bi-basket2-fill"></i> Añadir Producto</a>
                    {% endif %}
                    <a href="{% url 'user_logout' %}">Cerrar sesión</a>
                </div>
            </div>
            {% else %}
            <div class="auth-buttons">
                <a href="{% url 'login' %}" class="btn">Iniciar Sesión</a>
                <a href="{% url 'register' %}" class="btn">Registrarse</a>
            </div>
            {% endif %}
        </div>
    </header>

    <!-- Contenido Principal -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer-container">
        <div class="footer-content">
            <p>&copy; 2023 Viltrum. Todos los derechos reservados.</p>
            <div class="footer-links">
                <a href="#">Términos y Condiciones</a>
                <a href="#">Política de Privacidad</a>
                <a href="#">Contacto</a>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <!-- JS for Tooltip and Dropdown -->
        <script src="{% static 'core/js/dropMenu.js' %}"></script>
        {% if user.is_authenticated %}
        <script>const userId = "{{ user.id }}"; </script>
        <script src="{% static 'core/js/notifyWebSocket.js' %}"></script>
        {% endif %}
    {% block extra_js %}{% endblock %}
</body>

</html>
