{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Viltrum | Plataforma de eSports{% endblock %}</title>
    <!-- Fuente desde Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap">
    <!-- Archivo CSS -->
    <link type="text/css" rel="stylesheet" href="{% static 'core/css/template.css' %}">
    <!-- Iconos de Font Awesome y Bootstrap -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" />
    {% block extra_css %}{% endblock %}
</head>

<body>
    <!-- Header -->
    <header class="header-container">
        <div class="header-left">
            <!-- Logo con Animación -->
            <a href="{% url 'home' %}" class="logo-animation">
                <div class="loader">
                    <p>Viltrum</p>
                    <div class="words">
                        <span class="word">Valorant</span>
                        <span class="word">Minecraft</span>
                        <span class="word">League of Legends</span>
                        <span class="word">Apex</span>
                        <span class="word">Call of Duty</span>
                        <span class="word">Albion</span>
                        <span class="word">World of Warcraft</span>
                        <span class="word">Esports</span>
                    </div>
                </div>
            </a>
        </div>

        <!-- Navegación Central -->
        <nav class="nav-center">
            <a href="{% url 'home' %}" title="Inicio" class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}">
                <i class="bi bi-house-door-fill"></i> Inicio
            </a>
            <a href="{% url 'explore' %}" title="Explorar" class="nav-link {% if request.resolver_match.url_name == 'explore' %}active{% endif %}">
                <i class="bi bi-compass-fill"></i> Explorar
            </a>
            <a href="{% url 'tournaments' %}" title="Torneos" class="nav-link {% if request.resolver_match.url_name == 'tournaments' %}active{% endif %}">
                <i class="bi bi-trophy-fill"></i> Torneos
            </a>
            <a href="{% url 'clasifications' %}" title="Clasificaciones" class="nav-link {% if request.resolver_match.url_name == 'clasifications' %}active{% endif %}">
                <i class="bi bi-graph-up-arrow"></i> Clasificaciones
            </a>
        </nav>

        <!-- Sección Derecha -->
        <div class="header-right">
            <!-- Barra de Búsqueda -->
            <div class="search-bar">
                <input type="text" placeholder="Buscar">
                <button class="search-btn"><i class="bi bi-search"></i></button>
            </div>

            {% if user.is_authenticated %}
            <!-- Icono de Mensajes -->
            <a href="{% url 'chats_list' %}" title="Mensajes" class="icon-button">
                <i class="bi bi-chat-dots-fill"></i>
            </a>

            <!-- Menú Desplegable de Notificaciones -->
            <div class="dropdown">
                <button class="icon-button" id="notifyIcon">
                    <i class="bi bi-bell-fill"></i>
                    {% if notifications|length > 0 %}
                    <span class="badge">{{ notifications|length }}</span>
                    {% endif %}
                </button>
                <div class="dropdown-content" id="dropdownMenuNotify">
                    {% for notification in notifications %}
                    <div class="notification-item">
                        <strong>{{ notification.title }}</strong>
                        <p>{{ notification.message }}</p>
                    </div>
                    {% empty %}
                    <div class="notification-item">
                        <p>No hay nuevas notificaciones</p>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Menú Desplegable de Usuario -->
            <div class="dropdown">
                <button class="profile-button" id="userIcon">
                    <img src="{% if profile.profile_img %}{{ profile.profile_img.url }}{% else %}https://ui-avatars.com/api/?name={{ user }}{% endif %}" alt="Perfil">
                </button>
                <div class="dropdown-content" id="dropdownMenu">
                    <a href="{% url 'redirect_profile' %}"><i class="bi bi-person-fill"></i> Perfil</a>
                    <a href="{% url 'redirect_profile_edit' %}"><i class="bi bi-pencil-fill"></i> Editar Perfil</a>
                    {% if verified %}
                    <a href="#"><i class="bi bi-check-circle-fill"></i> Perfil verificado</a>
                    {% else %}
                    <a href="{% url 'verification' user %}"><i class="bi bi-shield-exclamation"></i> Verificar perfil</a>
                    {% endif %}
                    {% if role == 'gamer' %}
                    <a href="{% url 'games_stats' %}"><i class="bi bi-bar-chart-fill"></i> Estadísticas</a>
                    {% else %}
                    <a href="{% url 'sponsor_products' %}"><i class="bi bi-bag-fill"></i> Añadir Producto</a>
                    {% endif %}
                    <a href="{% url 'user_logout' %}"><i class="bi bi-box-arrow-right"></i> Cerrar sesión</a>
                </div>
            </div>
            {% else %}
            <!-- Botones de Autenticación -->
            <div class="auth-buttons">
                <a href="{% url 'login' %}" class="btn login-btn">Iniciar Sesión</a>
                <a href="{% url 'register' %}" class="btn register-btn">Regístrate</a>
            </div>
            {% endif %}
        </div>
    </header>

    <!-- Contenido -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="footer-container">
        <div class="footer-content">
            <p>© 2024 Viltrum. Todos los derechos reservados.</p>
            <div class="footer-links">
                <a href="#">Acerca de</a>
                <a href="#">Contacto</a>
                <a href="#">Privacidad</a>
                <a href="#">Términos</a>
                <a href="#">Ayuda</a>
            </div>
        </div>
    </footer>

    <!-- JS para Menús Desplegables -->
    <script src="{% static 'core/js/dropMenu.js' %}"></script>
    {% if user.is_authenticated %}
    <script>const userId = "{{ user.id }}"; </script>
    <script src="{% static 'core/js/notifyWebSocket.js' %}"></script>
    {% endif %}
    {% block extra_js %}{% endblock %}
</body>

</html>
